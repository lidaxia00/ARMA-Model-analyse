#include "update_buf.h"
#include <stdio.h>
#include <string.h>

predict_s predict_temp;

void update_bufs(predict_s *p, float d, float e, int buf_size)
{
	memmove(p->buf_temp, p->buf_temp + 1, sizeof(float) * (buf_size - 1));
	p->buf_temp[buf_size - 1] = d;
	memmove(p->e_data, p->e_data + 1, sizeof(float) * (buf_size - 1));
	p->e_data[buf_size - 1] = e;
}

const float sensor_err[300] = {-1.137085, -3.540039, -0.921234, -5.070709, -1.465027, 1.149017, -2.216919, -1.033417, -0.645325, -0.156067, -0.759155, 0.42984, -0.186768, -0.379669, 1.326141, -1.45343, -0.296509, 1.45813, 1.057404, 0.701385, -0.150085, -1.685791, 2.009064, 3.521149, 1.575104, 1.206085, 0.845215, 1.507568, 5.288727, 10.118927, -5.579285, -6.679169, -9.81134, -5.819809, 4.156906, -0.015991, 5.221542, -2.474792, 1.082153, -0.925217, -5.264999, 1.173355, 0.647156, -3.033752, -1.63028, 0.681351, -0.615631, -2.097534, 0.703903, 1.166672, -1.561325, 2.032211, 0.113083, -0.315216, 1.862671, 1.626877, -0.36113, 3.942474, 1.12558, 0.602631, 2.176331, 0.692673, 2.193619, -1.301437, 0.326462, 0.460136, -1.687029, -3.838373, 1.564363, -0.791008, 3.046309, 1.078858, -0.065569, -0.06036, 0.8932, -1.28817, 0.191742, -0.874329, 1.700562, -3.231323, -4.541595, -0.41507, 0.758087, -0.8974, -2.686554, -3.283447, 2.328217, -2.005524, 0.399933, -1.179016, -1.432617, 1.108459, -0.008057, 1.834045, -1.46991, 0.190247, 3.608154, 2.937317, 5.48877, 1.44928, -3.727844, -4.061768, -1.186218, 0.382385, -0.535889, 0.545837, -1.410889, 2.816528, -0.227844, -0.118042, 0.807739, 2.229248, 0.550934, 3.162506, -1.494324, -3.263794, 2.670715, 1.092773, -2.6996, -4.366013, -0.120422, -4.054543, -0.953695, -7.074709, -2.037647, -0.790359, 2.17952, -1.926842, 2.413696, 4.82811, 2.374908, -3.122154, -0.54427, 3.539366, 1.335266, -1.410629, 0.578178, 0.873848, 0.930801, -1.49437, -3.201721, 2.144684, -1.161255, -1.403931, -3.648865, -2.584259, -1.456543, -4.309875, -1.146027, -1.770081, 0.61853, 1.029602, -1.136932, 3.256836, 1.484863, 0.512939, -0.180298, 2.384125, -1.702423, 3.377411, -0.429657, 2.71051, -2.351349, -0.48819, -1.124969, -1.228973, -0.420715, 1.369446, -2.237061, 1.332092, 1.368195, 2.309479, 2.005066, -2.63916, 3.786255, 1.982056, 2.14624, 1.051605, 1.526367, 1.842804, 0.604309, 1.006134, 2.682922, 1.860962, -0.856445, 0.993256, -1.53833, -1.929321, -0.999512, 0.607056, 0.29866, 0.163605, -1.21106, -0.769867, 1.070068, 3.594971, 1.143623, 0.732826, 4.139244, -0.461823, -6.067413, -15.950752, 7.845657, -1.403717, 17.673752, 22.346207, -9.952713, 5.139496, 4.664246, 6.718414, 13.535187, -4.765625, 2.913208, 1.090393, -4.448792, -2.544495, -7.805542, -3.054077, 1.993225, -2.368225, 6.250732, -1.943604, 6.428711, 3.370728, 3.937378, 4.110779, 0.034393, 4.736542, 7.972107, -2.705536, 2.220917, -10.559845, -2.585602, -11.435753, 7.586464, -7.585701, -4.916054, -6.54319, -6.383591, 4.662544, -2.273939, -5.655998, -0.34354, -3.837755, -1.691026, -0.752276, 1.673794, -2.859316, -1.38522, 1.2943, 2.143486, -1.418682, 1.0215, 0.473927, 3.316483, 1.516254, -2.483591, 8.691524, -3.501871, 7.29767, 3.13283, -2.969444, -1.269638, 0.473972, -4.328995, -3.174568, -3.154927, -4.40871, -5.198051, -7.2033, -0.209091, -1.685349, -1.983856, 0.889984, -2.471252, 5.273987, 4.493469, -2.32251, -8.288513, 5.799255, -2.216614, 0.008423, -3.590515, -0.938171, 0.778442, 4.452393, -3.904419, 0.722656, -0.786682, 0.402893, 0.285095, 2.635803, 0.927917, 2.309021, 1.390503, 3.732849, 0.390686, -3.590576, -8.914978, 8.286438};
const float sensor_down[400] = {199, 263, 320, 370, 414, 451, 478, 496, 505, 506, 500, 486, 466, 440, 407, 372, 332, 289, 243, 194, 149, 104, 60, 15, -26, -65, -103, -138, -172, -203, -232, -258, -281, -299, -314, -326, -336, -343, -345, -344, -338, -328, -314, -302, -288, -271, -254, -237, -223, -209, -198, -190, -184, -180, -179, -179, -180, -183, -187, -191, -198, -204, -210, -216, -221, -225, -227, -228, -228, -225, -219, -211, -201, -192, -182, -166, -141, -113, -85, -67, -60, -56, -51, -41, -28, -21, -16, -13, -14, -15, -18, -22, -28, -34, -41, -47, -51, -54, -55, -55, -54, -50, -43, -34, -22, -7, 11, 30, 51, 72, 93, 113, 132, 148, 158, 166, 169, 168, 162, 150, 135, 115, 91, 65, 34, 2, -30, -64, -100, -134, -168, -201, -232, -262, -289, -314, -336, -357, -376, -393, -408, -423, -438, -451, -461, -465, -467, -466, -464, -461, -455, -446, -436, -421, -405, -386, -363, -336, -306, -272, -233, -193, -150, -106, -60, -11, 35, 80, 124, 163, 198, 226, 246, 260, 268, 268, 265, 255, 238, 215, 186, 154, 119, 82, 46, 10, -24, -56, -86, -110, -129, -143, -153, -157, -159, -158, -154, -147, -138, -129, -116, -105, -95, -88, -82, -80, -79, -80, -82, -88, -97, -107, -121, -138, -155, -175, -192, -208, -223, -237, -248, -256, -261, -262, -261, -256, -247, -236, -221, -203, -182, -161, -139, -114, -90, -66, -43, -21, 1, 20, 36, 50, 62, 70, 77, 81, 81, 70, 43, 6, -26, -48, -59, -76, -113, -172, -240, -299, -343, -375, -396, -409, -419, -433, -452, -470, -479, -475, -459, -432, -402, -369, -334, -298, -256, -204, -139, -66, 2, 43, 61, 71, 84, 108, 134, 155, 169, 176, 178, 177, 175, 170, 163, 156, 147, 141, 135, 131, 130, 130, 134, 142, 152, 163, 176, 187, 197, 205, 210, 211, 210, 202, 188, 170, 146, 114, 78, 36, -10, -65, -123, -184, -246, -310, -376, -439, -501, -559, -616, -664, -705, -740, -768, -790, -801, -806, -803, -793, -776, -754, -723, -687, -640, -591, -541, -495, -442, -370, -275, -169, -74, -5, 29, 50, 83, 137, 202, 261, 310, 352, 390, 422, 450, 471, 488, 497, 501, 501, 494, 479, 458, 431, 401, 370, 332, 284, 219, 140, 62, -6, -57, -98, -137, -176, -212, -244, -269, -290, -305, -315, -320, -321, -318, -311, -300, -286, -268, -246, -224, -200};
